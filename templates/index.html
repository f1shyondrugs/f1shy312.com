<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <title>Hello. I'm Das_F1sHy312</title>
    <meta name="viewport" content="width=device-width, user-scalable=no" />
    <link rel="shortcut icon" type="image/x-icon" href="/static/favicon.ico"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <link rel="stylesheet" href="/static/i-i.css">
    <link rel="stylesheet" href="/static/p712s9cjxyc01--123s.css">
    <link rel="stylesheet" href="/static/p41mvs8n127bnyxc78b19scnxy.css">
    <style>
        .spotify-widget {
            position: fixed;
            top: -500px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 1000;
            background: rgba(18, 18, 18, 0.8);
            border-radius: 10px;
            padding: 10px;
            width: fit-content;
            min-width: 300px;
            max-width: 400px;
            transition-duration: 1s;
            opacity: 1;
            animation: move-in-top 1s forwards;
            animation-delay: .75s;
        }

        @keyframes move-in-top {
            from { top: -500px; }
            to { top: 15px; }
        }

        .spotify-widget:hover {
            scale: 1.1;
            left: 50.7%;
        }

        .spotify-track {
            display: flex;
            align-items: center;
            gap: 10px;
            min-width: 300px;
        }

        .spotify-track .album-art {
            width: 60px;
            height: 60px;
            object-fit: cover;
            border-radius: 5px;
        }

        .track-info {
            flex: 1;
            overflow: hidden;
            margin-right: 10px;
        }

        .track-info a {
            text-decoration: none;
            color: #d3d3d3;
            display: block;
        }

        .track-info strong {
            display: block;
            font-size: 0.9rem;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .track-info p {
            font-size: 0.7rem;
            color: #888;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .audio-bars {
            display: flex;
            align-items: center;
            gap: 2px;
            height: 20px;
            padding-left: 10px;
            border-left: 1px solid rgba(211, 211, 211, 0.2);
        }

        .bar {
            width: 3px;
            background-color: #d3d3d3;
            animation: visualize 0.8s ease-in-out infinite alternate;
            border-radius: 1px;
        }

        .bar1 { animation-delay: 0s; height: 10px; }
        .bar2 { animation-delay: 0.2s; height: 15px; }
        .bar3 { animation-delay: 0.4s; height: 20px; }
        .bar4 { animation-delay: 0.6s; height: 15px; }
        .bar5 { animation-delay: 0.8s; height: 10px; }

        @keyframes visualize {
            0% { height: 5px; }
            100% { height: 20px; }
        }

        .spotify-controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 10px;
        }

        .control-button {
            background: #1f1f1f;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            font-size: 20px;
            color: #ffffff;
            cursor: pointer;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            transition-duration: .25s;
        }

        .control-button:hover {
            background: #333333;
            color: white;
        }

        .control-button:active {
            transform: scale(0.95);
        }

        .user-switcher {
            display: none; /* Hide by default */
            align-items: center;
            justify-content: center;
            margin-top: 10px;
            gap: 10px;
            opacity: 0;
            transition: opacity 0.3s ease-in-out;
        }

        .user-switcher.visible {
            display: flex;
            opacity: 1;
        }

        .user-label {
            color: white;
            font-size: 0.9em;
        }

        .spotify-search {
            margin-top: 10px;
            padding: 10px;
            background: rgba(18, 18, 18, 0.8);
            border-radius: 10px;
        }
        
        .search-input {
            width: 100%;
            padding: 8px;
            border: none;
            border-radius: 5px;
            background: #333;
            color: white;
            margin-bottom: 10px;
        }
        
        .search-results {
            max-height: 200px;
            overflow-y: auto;
        }
        
        .search-result {
            padding: 8px;
            cursor: pointer;
            color: white;
            border-radius: 5px;
            margin-bottom: 5px;
        }
        
        .search-result:hover {
            background: rgba(255, 255, 255, 0.1);
        }
        
        .search-result-title {
            font-weight: bold;
            font-size: 0.9em;
        }
        
        .search-result-artist {
            font-size: 0.8em;
            color: #888;
        }

        .lds-ring {
            display: inline-block;
            position: relative;
            width: 64px;
            height: 64px;
        }
        .lds-ring div {
            box-sizing: border-box;
            display: block;
            position: absolute;
            width: 51px;
            height: 51px;
            margin: 6px;
            border: 6px solid #fff;
            border-radius: 50%;
            animation: lds-ring 1.2s cubic-bezier(0.5, 0, 0.5, 1) infinite;
            border-color: #fff transparent transparent transparent;
        }
        .lds-ring div:nth-child(1) { animation-delay: -0.45s; }
        .lds-ring div:nth-child(2) { animation-delay: -0.3s; }
        .lds-ring div:nth-child(3) { animation-delay: -0.15s; }
        @keyframes lds-ring {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <script>
        var trail = document.createElement("div");
        trail.style.position = "absolute";
        trail.style.width = "10px";
        trail.style.height = "10px";
        trail.style.borderRadius = "50%";
        trail.style.backgroundColor = "#121212";
        trail.style.pointerEvents = "none";
        trail.style.transform = "translatex(-5px)"
        trail.style.zIndex = "9999";
        document.body.appendChild(trail);

        function updateTrail(e) {
            trail.style.backgroundColor = "rgba(255, 255, 255, 0.5)";
            trail.style.top = e.clientY + "px";
            trail.style.left = e.clientX + "px";
        }
        document.addEventListener("mousemove", updateTrail);

        

        window.addEventListener('DOMContentLoaded', () => {
            
            setInterval(updateSpotifyWidget, 10000);
        }); 

                
    </script>

    <div class="spotify-widget">
        <div id="spotify-users-container">
            <!-- Active users will be dynamically inserted here -->
        </div>

        <div id="spotify-controls" class="spotify-controls" style="display: none;">
            <button id="previous-track" class="control-button">
                <i class="fas fa-backward"></i>
            </button>
            <button id="pause-play" class="control-button">
                <i class="fas fa-play"></i>
            </button>
            <button id="skip-track" class="control-button">
                <i class="fas fa-forward"></i>
            </button>
        </div>

        <div id="user-switcher" class="user-switcher">
            <button id="switch-user" class="control-button">
                <i class="fas fa-exchange-alt"></i>
            </button>
            <span id="current-user-label" class="user-label">User </span>
        </div>

        <div id="spotify-search" class="spotify-search" style="display: none;">
            <input type="text" id="search-input" class="search-input" placeholder="Search for a song...">
            <div id="search-results" class="search-results"></div>
        </div>
    </div>

    <div class="container">
        <div class="intro">
            <p>
                <span id="demo">Hello. I'm Das_F1sHy312</span><br>
                <a style="font-size: small;"><span style='color: #f49d2b;'><</span>Developer<span style='color: #f49d2b;'>/></span> & <span style='color: #f4cf2b;'><</span>Content Creator<span style='color: #f4cf2b;'>/></span></a>
            </p>
        </div>
        <script>
            var i = 0;
                var txt = "Hello. I'm Das_F1sHy312";
                var speed = 40;
                window.onload = typeWriter;
                document.getElementById("demo").innerHTML = ""
                function typeWriter() {
                    
                    if (i < txt.length) {
                        document.getElementById("demo").innerHTML += txt.charAt(i);
                        i++;
                        setTimeout(typeWriter, speed);
                    }
                }
        </script>

        <div class="">
            

            <div id="spotify-search" class="spotify-search" style="display: none;">
                <input type="text" id="search-input" class="search-input" placeholder="Search for a song...">
                <div id="search-results" class="search-results"></div>
            </div>

            <style>
                .spotify-search {
                    margin-top: 10px;
                    padding: 10px;
                    background: rgba(18, 18, 18, 0.8);
                    border-radius: 10px;
                }
                
                .search-input {
                    width: 100%;
                    padding: 8px;
                    border: none;
                    border-radius: 5px;
                    background: #333;
                    color: white;
                    margin-bottom: 10px;
                }
                
                .search-results {
                    max-height: 200px;
                    overflow-y: auto;
                }
                
                .search-result {
                    padding: 8px;
                    cursor: pointer;
                    color: white;
                    border-radius: 5px;
                    margin-bottom: 5px;
                }
                
                .search-result:hover {
                    background: rgba(255, 255, 255, 0.1);
                }
                
                .search-result-title {
                    font-weight: bold;
                    font-size: 0.9em;
                }
                
                .search-result-artist {
                    font-size: 0.8em;
                    color: #888;
                }
                </style>
        </div>
        <div class="card-container">
            <div onclick="window.location.href = '/aboutme'" class="card one">
                <div class="card-content">
                    <h3>About me</h3>
                    <p>Learn More About Me</p>
                </div>
                <div class="icon-container"><i class="fas fa-user"></i></div>
            </div>
            <div onclick="window.location.href = '/projects'" class="card two">
                <div class="card-content">
                    <h3>Projects</h3>
                    <p>Check out my projects!</p>
                </div>
                <div class="icon-container"><i class="fab fa-github"></i></div>
            </div>
            <div onclick="window.location.href = 'https://www.youtube.com/channel/UCN8CHrW-ZLvP9rTN52NwFXw'" class="card three">
                <div class="card-content">
                    <h3>YouTube</h3>
                    <p>Subscribe to my YouTube channel!</p>
                </div>
                <div class="icon-container"><i class="fab fa-youtube"></i></div>
            </div>
            <div onclick="window.location.href = 'https://twitch.tv/f1shy312'" class="card four">
                <div class="card-content">
                    <h3>Twitch</h3>
                    <p>Follow me on Twitch!</p>
                </div>
                <div class="icon-container"><i class="fab fa-twitch"></i></div>
            </div>
        </div>

        <div class="test-container" onclick="document.querySelector('.test-container').style.display = 'none'; document.querySelector('.content').style.display = 'block'"></div>
        <div class="content">
            <p style="text-align: center; color: rgb(80, 80, 80);">Made with <3 by Das_F1sHy312<br>This Website looks best on Desktop<br><br></p>

            <script>
                function emailevent() {
                    const originalText = "Hello. I'm Das_F1sHy312   ";
                    const targetText = "Email copied to clipboard!";
                    const textElement = document.getElementById("demo");
                    let currentText = textElement.innerHTML;
                    let currentIndex = 0;
                    let isReverting = false;
                    const animationSpeed = 50;

                    navigator.clipboard.writeText('info@f1shy312.com')
                        .then(() => {
                            animateText();
                        })
                        .catch(err => {
                            console.error('Failed to copy email: ', err);
                        });

                    function animateText() {
                        if (!isReverting) {
                            if (currentIndex < targetText.length) {
                                let newText = currentText.split('');
                                newText[currentIndex] = targetText[currentIndex];
                                currentText = newText.join('');
                                textElement.innerHTML = currentText;
                                currentIndex++;
                                setTimeout(animateText, animationSpeed);
                            } else {
                                setTimeout(() => {
                                    isReverting = true;
                                    currentIndex = 0;
                                    animateText();
                                }, 2000);
                            }
                        } else {
                            if (currentIndex < originalText.length) {
                                let newText = currentText.split('');
                                newText[currentIndex] = originalText[currentIndex];
                                currentText = newText.join('');
                                textElement.innerHTML = currentText;
                                currentIndex++;
                                setTimeout(animateText, animationSpeed);
                            }
                        }
                    }

                    
                }

                function discordevent() {
                    const originalText = "Hello. I'm Das_F1sHy312      ";
                    const targetText = "Discord copied to clipboard!";
                    const textElement = document.getElementById("demo");
                    let currentText = textElement.innerHTML;
                    let currentIndex = 0;
                    let isReverting = false;
                    const animationSpeed = 50;

                    navigator.clipboard.writeText('f1shyondrugs312')
                        .then(() => {
                            animateText();
                        })
                        .catch(err => {
                            console.error('Failed to copy Discord username: ', err);
                        });

                    function animateText() {
                        if (!isReverting) {
                            if (currentIndex < targetText.length) {
                                let newText = currentText.split('');
                                newText[currentIndex] = targetText[currentIndex];
                                currentText = newText.join('');
                                textElement.innerHTML = currentText;
                                currentIndex++;
                                setTimeout(animateText, animationSpeed);
                            } else {
                                setTimeout(() => {
                                    isReverting = true;
                                    currentIndex = 0;
                                    animateText();
                                }, 2000);
                            }
                        } else {
                            if (currentIndex < originalText.length) {
                                let newText = currentText.split('');
                                newText[currentIndex] = originalText[currentIndex];
                                currentText = newText.join('');
                                textElement.innerHTML = currentText;
                                currentIndex++;
                                setTimeout(animateText, animationSpeed);
                            }
                        }
                    }

                    
                }
            </script>
            <p style="text-align: center; color: rgb(80, 80, 80);">
                <a style="color: rgb(80, 80, 80);" href="#" onclick="navigator.clipboard.writeText('info@f1shy312.com'); emailevent(); return false;">
                    info@f1shy312.com<span style="font-size: small; user-select: auto;"> [Copy] </span>
                </a><br>
                <a style="color: rgb(80, 80, 80);" href="#" onclick="navigator.clipboard.writeText('f1shyondrugs312'); discordevent(); return false;">
                    Discord: f1shyondrugs312<span style="font-size: small; user-select: auto;"> [Copy] </span>
                </a><br>
            </p>
        </div>


    <script>
        let currentUserStates = {};
        async function updateSpotifyWidget() {
            const users = ['user1', 'user2', 'user3'];
            const spotifyUsersContainer = document.getElementById('spotify-users-container');
            let newUserStates = {};
            let activeUsersFound = false;

            for (const user of users) {
                try {
                    const response = await fetch(`/now-playing/${user}`);
                    const data = await response.json();
                    
                    if (data.status === 'playing') {
                        activeUsersFound = true;
                        newUserStates[user] = {
                            track_name: data.track_name,
                            artist: data.artist,
                            album_art: data.album_art,
                            spotify_link: data.spotify_link,
                            display_name: data.display_name
                        };

                        let userDiv = document.getElementById(`user-container-${user}`);
                        const currentState = currentUserStates[user];

                        if (!userDiv) {
                            userDiv = document.createElement('div');
                            userDiv.id = `user-container-${user}`;
                            userDiv.className = 'user-container';
                            spotifyUsersContainer.appendChild(userDiv);
                        }

                        if (!currentState || 
                            currentState.track_name !== data.track_name || 
                            currentState.artist !== data.artist) {
                            
                            userDiv.innerHTML = `
                                <div class="spotify-track">
                                    <img src="${data.album_art}" alt="Album Art" class="album-art">
                                    <div class="track-info">
                                        <a href="${data.spotify_link}" target="_blank">
                                            <strong>${data.track_name}</strong>
                                            <p>${data.artist}</p>
                                        </a>
                                    </div>
                                    <div class="audio-bars">
                                        <div class="bar bar1"></div>
                                        <div class="bar bar2"></div>
                                        <div class="bar bar3"></div>
                                        <div class="bar bar4"></div>
                                        <div class="bar bar5"></div>
                                    </div>
                                </div>
                                <div class="user-label" style="text-align: right; margin-top: 5px; font-size: 0.8em; color: #888;">
                                    ${data.display_name}
                                </div>
                            `;
                        }
                    }
                } catch (error) {
                    console.error(`Error fetching data for ${user}:`, error);
                }
            }

            Object.keys(currentUserStates).forEach(user => {
                if (!newUserStates[user]) {
                    const userDiv = document.getElementById(`user-container-${user}`);
                    if (userDiv) {
                        userDiv.classList.add('fade-out');
                        setTimeout(() => {
                            if (userDiv.parentNode) {
                                userDiv.parentNode.removeChild(userDiv);
                            }
                        }, 300);
                    }
                }
            });

            let noActiveUsersDiv = document.querySelector('.no-active-users');
            if (!activeUsersFound) {
                if (!noActiveUsersDiv) {
                    noActiveUsersDiv = document.createElement('div');
                    noActiveUsersDiv.className = 'no-active-users';
                    noActiveUsersDiv.textContent = '';
                    spotifyUsersContainer.appendChild(noActiveUsersDiv);
                }
            } else if (noActiveUsersDiv) {
                noActiveUsersDiv.classList.add('fade-out');
                setTimeout(() => {
                    if (noActiveUsersDiv.parentNode) {
                        noActiveUsersDiv.parentNode.removeChild(noActiveUsersDiv);
                    }
                }, 300);
            }

            const currentUser = localStorage.getItem('currentUser') || 'user1';
            const userLabel = document.getElementById('current-user-label');
            if (newUserStates[currentUser]) {
                userLabel.textContent = newUserStates[currentUser].display_name;
            } else {
                userLabel.textContent = currentUser === 'user1' ? 'User 1' : 'User 2';
            }

            currentUserStates = newUserStates;
        }


        if (!localStorage.getItem('currentUser')) {
            localStorage.setItem('currentUser', 'user1');
        }

        let keySequence = '';
        
        document.addEventListener('DOMContentLoaded', () => {
            const spotifyControls = document.getElementById('spotify-controls');
            const searchInput = document.getElementById('search-input');
            const searchResults = document.getElementById('search-results');
            const spotifySearch = document.getElementById('spotify-search');
            const switchButton = document.getElementById('switch-user');
            const userSwitcher = document.getElementById('user-switcher');
            let searchTimeout = null;
            
            function updateSwitcherVisibility() {
                const isControlsVisible = spotifyControls.style.display === 'flex';
                const isSearchVisible = spotifySearch.style.display === 'block';
                
                if (isControlsVisible || isSearchVisible) {
                    userSwitcher.classList.add('visible');
                } else {
                    userSwitcher.classList.remove('visible');
                }
            }

            switchButton.addEventListener('click', () => {
                const currentUser = localStorage.getItem('currentUser');
                let newUser;
                switch(currentUser) {
                    case 'user1':
                        newUser = 'user2';
                        break;
                    case 'user2':
                        newUser = 'user3';
                        break;
                    default:
                        newUser = 'user1';
                }
                localStorage.setItem('currentUser', newUser);
                document.getElementById('current-user-label').textContent = `User ${newUser.slice(-1)}`;
                updateSpotifyWidget();
            });

            document.addEventListener('keydown', (event) => {
                if (event.key === ' ') {
                    event.preventDefault();
                }
                
                if (/^[a-zA-Z0-9]$/.test(event.key)) {
                    keySequence += event.key.toLowerCase();
                    
                    if (keySequence.length > 7) {
                        keySequence = keySequence.slice(-7);
                    }
                    
                    if (keySequence.slice(-7) === 'spotify') {
                        spotifyControls.style.display = 'flex';
                        updateSwitcherVisibility();
                        keySequence = '';
                    } else if (keySequence.slice(-6) === 'search') {
                        spotifySearch.style.display = 'block';
                        searchInput.focus();
                        updateSwitcherVisibility();
                        keySequence = '';
                    } else if (keySequence.slice(-5) === 'reset') {
                        keySequence = '';
                        alert('Reset KeySequence')
                        // Future Debug Mode
                    }
                } else if (event.key === 'Escape') {
                    spotifyControls.style.display = 'none';
                    spotifySearch.style.display = 'none';
                    searchInput.value = '';
                    searchResults.innerHTML = '';
                    keySequence = '';
                    updateSwitcherVisibility();
                }
            });


            function addToQueueAndSkip(uri) {
                const currentUser = localStorage.getItem('currentUser');
                fetch('/add-to-queue', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ 
                        uri: uri,
                        user_id: currentUser
                    })
                })
                .then(response => response.json())
                .then(data => {
                    if (data.status === 'success') {
                        setTimeout(() => {
                            fetch('/spotify-skip', {
                                method: 'POST',
                                headers: {
                                    'Content-Type': 'application/json',
                                },
                                body: JSON.stringify({ user_id: currentUser })
                            })
                            .then(response => response.json())
                            .then(skipData => {
                                if (skipData.status === 'success') {
                                    keySequence = '';                                    
                                    setTimeout(() => {
                                        updateSpotifyWidget();
                                    }, 500);

                                    const searchInput = document.getElementById('search-input');
                                    const searchResults = document.getElementById('search-results');
                                    const spotifySearch = document.getElementById('spotify-search');
                                    if (searchInput) searchInput.value = '';
                                    if (searchResults) searchResults.innerHTML = '';
                                    if (spotifySearch) spotifySearch.style.display = 'none';
                                } else {
                                    console.error('Skip error:', skipData.message);
                                    alert('Error skipping track: ' + skipData.message);
                                }
                            });
                        }, 300);
                    } else {
                        console.error('Queue error:', data.message);
                        alert('Error adding to queue: ' + data.message);
                    }
                })
                .catch(error => {
                    console.error('Error adding to queue:', error);
                    alert('Error adding to queue: ' + error);
                });
            }
            searchInput.addEventListener('input', (e) => {
                clearTimeout(searchTimeout);
                const currentUser = localStorage.getItem('currentUser');
                
                searchTimeout = setTimeout(() => {
                    const query = e.target.value.trim();
                    if (query.length > 0) {
                        fetch('/spotify-search', {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json',
                            },
                            body: JSON.stringify({ 
                                query: query,
                                user_id: currentUser
                            })
                        })
                        .then(response => response.json())
                        .then(data => {
                            if (data.status === 'success') {
                                searchResults.innerHTML = '';
                                data.tracks.forEach(track => {
                                    const div = document.createElement('div');
                                    div.className = 'search-result';
                                    div.innerHTML = `
                                        <div class="search-result-title">${track.name}</div>
                                        <div class="search-result-artist">${track.artist}</div>
                                    `;
                                    div.addEventListener('click', () => {
                                        addToQueueAndSkip(track.uri);
                                    });
                                    searchResults.appendChild(div);
                                });
                            }
                        })
                        .catch(error => console.error('Error searching:', error));
                    }
                }, 300);
            });

            document.getElementById('skip-track').addEventListener('click', () => {
                const currentUser = localStorage.getItem('currentUser');
                fetch('/spotify-skip', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ user_id: currentUser })
                })
                .then(response => response.json())
                .then(data => {
                    if (data.status === 'success') {
                        setTimeout(() => {
                            updateSpotifyWidget();
                        }, 500);
                    }
                })
                .catch(error => console.error('Error:', error));
            });

            document.getElementById('previous-track').addEventListener('click', () => {
                const currentUser = localStorage.getItem('currentUser');
                fetch('/spotify-previous', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ user_id: currentUser })
                })
                .then(response => response.json())
                .then(data => {
                    if (data.status === 'success') {
                        setTimeout(() => {
                            updateSpotifyWidget();
                        }, 500);
                    }
                })
                .catch(error => console.error('Error:', error));
            });

            document.getElementById('pause-play').addEventListener('click', () => {
                const currentUser = localStorage.getItem('currentUser');
                fetch('/spotify-pause-play', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ user_id: currentUser })
                })
                .then(response => response.json())
                .then(data => {
                    if (data.status === 'success') {
                        const button = document.getElementById('pause-play');
                        const icon = button.querySelector('i');
                        
                        if (data.message === 'Playback paused') {
                            icon.classList.replace('fa-pause', 'fa-play');
                        } else {
                            icon.classList.replace('fa-play', 'fa-pause');
                        }
                        
                        setTimeout(() => {
                            updateSpotifyWidget();
                        }, 300);
                    }
                })
                .catch(error => console.error('Error:', error));
            });

            updateSpotifyWidget();
        });

        function playTrack(uri) {
            const currentUser = localStorage.getItem('currentUser');
            fetch('/spotify-play', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ 
                    uri: uri,
                    user_id: currentUser
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.status === 'success') {
                    const pausePlayButton = document.getElementById('pause-play');
                    if (pausePlayButton) {
                        const icon = pausePlayButton.querySelector('i');
                        icon.classList.replace('fa-play', 'fa-pause');
                    }
                    updateSpotifyWidget();
                    const searchInput = document.getElementById('search-input');
                    const searchResults = document.getElementById('search-results');
                    const spotifySearch = document.getElementById('spotify-search');
                    if (searchInput) searchInput.value = '';
                    if (searchResults) searchResults.innerHTML = '';
                    if (spotifySearch) spotifySearch.style.display = 'none';
                } else {
                    console.error('Playback error:', data.message);
                    alert('Playback error: ' + data.message);
                }
            })
            .catch(error => {
                console.error('Error playing track:', error);
                alert('Error playing track: ' + error);
            });
        }
    </script>
</body>
</html>
